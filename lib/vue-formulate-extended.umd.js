!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@braid/vue-formulate"),require("@braid/vue-formulate/src/libs/utils.js"),require("imask"),require("@braid/vue-formulate/src/Formulate")):"function"==typeof define&&define.amd?define(["exports","@braid/vue-formulate","@braid/vue-formulate/src/libs/utils.js","imask","@braid/vue-formulate/src/Formulate"],t):t((e=e||self).VueFormulateExtended={},e.VueFormulate,e.utils_js,e.IMask,e.Formulate$1)}(this,(function(e,t,o,r,n){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n;var s=function(e){return void 0===e&&(e=[]),this.defaultHook=function(e){return e},this.setHooks(e)};s.prototype.parse=function(e){void 0===e&&(e=[]);var t=Array.isArray(e)?e:[];for(var o of t)this.isProperHook(o)&&this.hooks.push(o);return this},s.prototype.addHook=function(e){return this.isProperHook(e)&&this.isNewHook(e)&&this.hooks.push(e),this},s.prototype.setHooks=function(e){return void 0===e&&(e=[]),this.hooks=e.filter(this.isProperHook),this},s.prototype.setDefault=function(e){return this.defaultHook=e,this},s.prototype.isProperHook=function(e){return e&&"object"==typeof e&&"function"==typeof e.handler},s.prototype.isNewHook=function(e){return this.hooks.findIndex((function(t){return t===e}))<0},s.prototype.getHooks=function(){return this.hooks},s.prototype.empty=function(){return 0===this.hooks.length},s.prototype.apply=function(e,t){return this.empty()?this.defaultHook(e,t):this.hooks.reduce((function(e,o){return o.handler(e,t)}),e)},s.prototype.asSingleHook=function(){var e=this;return{handler:function(t,o){return e.apply(t,o)}}};var a={type:Object,default:function(){return{model:[],schema:[],schemaOptions:[],schemaNode:[],schemaComponent:[]}}};function i(e,t,o,r,n,s,a,i,u,c){"boolean"!=typeof a&&(u=i,i=a,a=!1);var d,f="function"==typeof o?o.options:o;if(e&&e.render&&(f.render=e.render,f.staticRenderFns=e.staticRenderFns,f._compiled=!0,n&&(f.functional=!0)),r&&(f._scopeId=r),s?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,u(e)),e&&e._registeredComponents&&e._registeredComponents.add(s)},f._ssrRegister=d):t&&(d=a?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,i(e))}),d)if(f.functional){var l=f.render;f.render=function(e,t){return d.call(t),l(e,t)}}else{var p=f.beforeCreate;f.beforeCreate=p?[].concat(p,d):[d]}return o}var u=i({},void 0,{extends:t.defaults.components.FormulateInput,props:{modelHook:{type:[Function,Object,Array],default:null}},watch:{"context.model":{handler:function(e,t){var o=new s;Array.isArray(this.modelHook)?this.modelHook.map((function(e){return o.addHook(e)})):"function"==typeof this.modelHook?o.addHook({handler:this.modelHook}):o.addHook(this.modelHook),(this.$formulate.options.hooks&&this.$formulate.options.hooks.model?this.$formulate.options.hooks.model:[]).map((function(e){return o.addHook(e)})),e!==t&&(this.context.model=o.apply(e,{oldModel:t,context:this.context}))}}}},void 0,void 0,void 0,!1,void 0,void 0,void 0);function c(e,t,o){void 0===o&&(o={});var r=o.hooks,n=o.h,a=o.state;if(e&&"object"==typeof e&&!Array.isArray(e)){var i=e.children;void 0===i&&(i=null);var c=e.component;void 0===c&&(c=u);var f=e.depth;void 0===f&&(f=1);var l=e.modelHook,p=function(e,t){var o={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&-1===t.indexOf(r)&&(o[r]=e[r]);return o}(e,["children","component","depth","modelHook"]),m=c===u?p.type||"text":"",h=p.name||m||"el",v=p.id||h+"-"+f+"-"+t,k=Array.isArray(i)?i.map((function(e){return Object.assign(e,{depth:f+1})})):i,y=(new s).setHooks(r.model).addHook(l).asSingleHook(),b=Object.assign({type:m,key:v,depth:f,component:c,definition:{attrs:Object.assign({},p,{modelHook:y})},children:d(k,{hooks:r,h:n,state:a})});return(new s).setHooks(r.schemaNode).setDefault((function(){return b})).apply(b,{state:a})}return null}function d(e,t){void 0===t&&(t={});var o=t.hooks,r=t.h,n=t.state;return Array.isArray(e)?e.map((function(e,t){var a=c(e,t,{hooks:o,h:r,state:n});return(new s).setHooks(o.schemaComponent).setDefault((function(){return r(a.component,a.definition,a.children)})).apply(a)})):e}var f={functional:!0,name:"FormulateSchema",props:{schema:t.defaults.components.FormulateForm.props.schema,hooks:a},data:function(){return{schemaHooks:null,schemaOptionsHooks:null}},mounted:function(){this.schemaHooks=(new s).setHooks(this.hooks.schema),this.schemaOptionsHooks=(new s).setHooks(this.hooks.schemaOptions).setDefault((function(e){return e}))},render:function(e,t){var o=t.props,r=(new s).setHooks(o.hooks.schema),n=(new s).setHooks(o.hooks.schemaOptions).setDefault((function(e){return e}));return function(){return r.apply(e("div",{},d(o.schema,n.apply({hooks:o.hooks,h:e,state:{}},{emit:emit,props:o}))),{emit:emit,props:o})}}},l={extends:t.defaults.components.FormulateForm,components:{FormulateSchema:f},props:{hooks:a},computed:{cleanedHooks:function(){var e=this,o=a.default();return Object.keys(o).forEach((function(t){o[t]=(new s).parse(e.hooks[t]).getHooks()})),t.merge(this.$formulate.options.hooks||{},o)}},watch:{formulateValue:{handler:function(e){var t=this;this.isVmodeled&&e&&"object"==typeof e&&Array.from(new Set(Object.keys(e).concat(Object.keys(this.proxy)))).forEach((function(r){o.shallowEqualObjects(e[r],t.proxy[r])||(t.setFieldValue(r,e[r]),t.registry.has(r)&&!o.shallowEqualObjects(e[r],t.registry.get(r).proxy)&&(t.registry.get(r).context.model=e[r]))}))},deep:!0}}},p=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("form",{class:e.classes,on:{submit:function(t){return t.preventDefault(),e.formSubmitted(t)}}},[e.schema?o("FormulateSchema",{attrs:{schema:e.schema,hooks:e.cleanedHooks},on:{events:function(t){return e.$emit("events",t)}}}):e._e(),e._v(" "),e.hasFormErrorObservers?e._e():o("FormulateErrors",{attrs:{context:e.formContext}}),e._v(" "),e._t("default")],2)};p._withStripped=!0;var m=i({render:p,staticRenderFns:[]},void 0,l,void 0,!1,void 0,!1,void 0,void 0,void 0),h=function(){this.store=new Map};h.prototype.on=function(e,t){var o=this.store.get(e);o&&o.push(t)||this.store.set(e,[t])},h.prototype.off=function(e,t){var o=this.store.get(e),r=o.indexOf(t);o&&r>-1&&o.splice(r,1)},h.prototype.emit=function(e,t){this.store.get(e).slice().map((function(e){return e(t)}))};var v={hooks:{schemaOptions:[{handler:function(e,t){void 0===t&&(t={});var o=t.emit;return e.state=e.state||{},e.state.eventBus=new h,e.state.eventBus.on("events",(function(e){return o("events",e)})),e}}],schemaNode:[{handler:function(e,t){void 0===t&&(t={});var o=t.state,r=e.definition.attrs,n=r.events;void 0===n&&(n=[]);var s=r.on;void 0===s&&(s={});var a=function(e,t){var o={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&-1===t.indexOf(r)&&(o[r]=e[r]);return o}(r,["events","on"]);return e.definition.attrs=a,e.definition.on=Object.assign({},s,n.reduce((function(t,r){return t[r]=function(t){s[r]&&s[r](t),o.eventBus.emit("events",{eventName:r,name:e.name,type:e.type,key:e.key,payload:t})},t}),{})),e}}]}},k={hooks:{model:[{handler:function(e,t){var o=t.context,n="vfe-mask"in o.attributes||"vfeMask"in o.attributes;if("text"===o.classification&&n){var s=o.attributes["vfe-mask"]||o.attributes.vfeMask,a="object"==typeof s&&s.mask?s:{mask:s};return r.createMask(a).resolve(e)}return e}}]}},y={hooks:{model:[{handler:function(e,t){var o=t.context,r="string"==typeof o.attributes.vfeNumber||o.attributes.vfeNumber||"string"==typeof o.attributes["vfe-number"]||o.attributes["vfe-number"];return"number"===o.type&&"string"==typeof e&&r?+e:e}}]}},b={FormulateForm:m,FormulateSchema:f,FormulateInput:u},H={formEvents:v,textMask:k,enforceNumber:y};e.components=b,e.default=function(e){void 0===e&&(e={});var t=n.merge({features:{formEvents:!0,textMask:!1,enforceNumber:!1},override:{FormulateForm:!0,FormulateInput:!0,FormulateSchema:!0}},e);return function(e){t.override.FormulateForm&&e.extend({components:{FormulateForm:m}}),t.override.FormulateInput&&e.extend({components:{FormulateInput:u}}),t.override.FormulateSchema&&e.extend({components:{FormulateSchema:f}}),t.features.formEvents&&e.extend(v),t.features.textMask&&e.extend(k),t.features.enforceNumber&&e.extend(y)}},e.features=H,Object.defineProperty(e,"__esModule",{value:!0})}));
